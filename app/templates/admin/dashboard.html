{% extends "admin/base_admin.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <h1 class="admin-page-title">Dashboard</h1>
  <span class="text-muted">Welcome back, {{ current_user.username }}</span>
</div>

<!-- ‚îÄ‚îÄ Stat Cards ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<div class="row g-4 mb-5">
  <div class="col-sm-6 col-xl-3">
    <div class="stat-card">
      <div class="stat-icon bg-gold-soft"><i class="bi bi-gem"></i></div>
      <div class="stat-info">
        <p class="stat-label">Active Products</p>
        <h3 class="stat-value">{{ stats.total_products }}</h3>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-xl-3">
    <div class="stat-card">
      <div class="stat-icon bg-blue-soft"><i class="bi bi-bag-check"></i></div>
      <div class="stat-info">
        <p class="stat-label">Total Orders</p>
        <h3 class="stat-value">{{ stats.total_orders }}</h3>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-xl-3">
    <div class="stat-card">
      <div class="stat-icon bg-orange-soft"><i class="bi bi-clock-history"></i></div>
      <div class="stat-info">
        <p class="stat-label">Pending Orders</p>
        <h3 class="stat-value">{{ stats.pending_orders }}</h3>
      </div>
    </div>
  </div>
  <div class="col-sm-6 col-xl-3">
    <div class="stat-card">
      <div class="stat-icon bg-green-soft"><i class="bi bi-tags"></i></div>
      <div class="stat-info">
        <p class="stat-label">Categories</p>
        <h3 class="stat-value">{{ stats.total_categories }}</h3>
      </div>
    </div>
  </div>
</div>

<div class="row g-4">
  <!-- ‚îÄ‚îÄ Recent Orders ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="col-lg-8">
    <div class="admin-card">
      <div class="admin-card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Recent Orders</h5>
        <a href="{{ url_for('admin_bp.orders') }}" class="btn btn-sm btn-outline-secondary">
          View All
        </a>
      </div>
      <div class="admin-card-body p-0">
        {% if stats.recent_orders %}
        <div class="table-responsive">
          <table class="table admin-table mb-0">
            <thead>
              <tr>
                <th>Order #</th>
                <th>Customer</th>
                <th>Total</th>
                <th>Status</th>
                <th>Date</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {% for order in stats.recent_orders %}
              <tr>
                <td><code>{{ order.order_number }}</code></td>
                <td>{{ order.customer_name }}</td>
                <td>${{ '%.2f'|format(order.total_amount|float) }}</td>
                <td>
                  <span class="status-badge status-{{ order.status }}">
                    {{ order.status|title }}
                  </span>
                </td>
                <td class="text-muted small">
                  {{ order.created_at.strftime('%d %b %Y') }}
                </td>
                <td>
                  <a href="{{ url_for('admin_bp.order_detail', order_id=order.id) }}"
                     class="btn btn-xs btn-outline-primary">View</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
          <p class="text-muted p-3">No orders yet.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ Low Stock Alert ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="col-lg-4">
    <div class="admin-card">
      <div class="admin-card-header">
        <h5 class="mb-0"><i class="bi bi-exclamation-triangle-fill text-warning me-2"></i>Low Stock</h5>
      </div>
      <div class="admin-card-body">
        {% if stats.low_stock %}
          {% for p in stats.low_stock %}
          <div class="d-flex align-items-center justify-content-between mb-2 low-stock-row">
            <span class="small">{{ p.name }}</span>
            <span class="badge {% if p.stock == 0 %}bg-danger{% else %}bg-warning text-dark{% endif %}">
              {{ p.stock }} left
            </span>
          </div>
          {% endfor %}
          <a href="{{ url_for('admin_bp.products') }}" class="btn btn-sm btn-outline-warning w-100 mt-2">
            Manage Products
          </a>
        {% else %}
          <p class="text-muted small">All products have sufficient stock. üëç</p>
        {% endif %}
      </div>
    </div>

    <!-- Quick links -->
    <div class="admin-card mt-4">
      <div class="admin-card-header">
        <h5 class="mb-0">Quick Actions</h5>
      </div>
      <div class="admin-card-body d-grid gap-2">
        <a href="{{ url_for('admin_bp.product_add') }}" class="btn btn-admin-primary">
          <i class="bi bi-plus-circle me-2"></i>Add Product
        </a>
        <a href="{{ url_for('admin_bp.orders', status='pending') }}" class="btn btn-outline-secondary">
          <i class="bi bi-clock me-2"></i>View Pending Orders
        </a>
        <a href="{{ url_for('admin_bp.settings') }}" class="btn btn-outline-secondary">
          <i class="bi bi-gear me-2"></i>Site Settings
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
